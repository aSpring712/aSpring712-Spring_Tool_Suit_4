<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="com.example.demo.dao.BoardMapper">
 
 <sql id = "search">
 	<where>
 		<if test="word != null and field == 'writer'">
 			writer like CONCAT ('%', #{word}, '%')
 		</if>
 		<if test="word != null and field == 'content'">
 			content like CONCAT ('%', #{word}, '%')
 		</if>
 		<if test="word != null and field == 'title'">
 			title like CONCAT ('%', #{word}, '%')
 		</if>
 	</where>
 </sql>
 
 <!-- application.properties에서 vo location 설정을 해줘서 com. ~~ 안적고 이렇게만 적어도 됨 --> 
 <select id="list" resultType="BoardDTO">
	 select * from board
	 <include refid="search"/>
	 order by num desc limit #{pageStart}, #{pageSize}
 </select>
 
 <select id="getCount" resultType="int">
 	select count(*) from board
 	<include refid="search"/>	
 </select>
 
 <select id="view" resultType="BoardDTO">
 	select * from board where num = #{num}
 </select>
 
 <insert id="insert">
	 insert into board(title, writer, content, regdate) 
	 values(#{title}, #{writer}, #{content}, now());
 </insert>
 
 <update id="updateHitcount">
	 update board set hitcount = hitcount + 1
	 where num = #{num}
 </update>
 
 <delete id="delete">
 	delete from board where num = #{num}
 </delete>
 
 <update id="update">
 	update board set title = #{title}, content = #{content}, regdate = now() where num = #{num}
 </update>
 
 </mapper>